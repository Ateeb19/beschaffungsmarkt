"use strict";(self.webpackChunkbeschaffungsmarkt=self.webpackChunkbeschaffungsmarkt||[]).push([[2648],{2648:(e,s,a)=>{a.r(s),a.d(s,{default:()=>g});var t=a(9379),l=a(5043),n=a(8789),r=a(5394),c=a(2021),d=a(3003),i=a(7706),o=a(9981),m=a(502),u=a(9722),f=a(6720),x=a(423),p=a(579);const h=e=>{let{accept:s,onFileDrop:a,label:r,className:c}=e;const d=(0,l.useCallback)(e=>{if(e.length>0){const s=e[0];a(s)}},[a]),{getRootProps:i,getInputProps:o,isDragActive:m}=(0,n.VB)({onDrop:d,accept:s,multiple:!1});return(0,p.jsxs)("div",(0,t.A)((0,t.A)({},i()),{},{className:"d-flex flex-column align-items-center justify-content-center text-center ".concat(c),children:[(0,p.jsx)("input",(0,t.A)({},o())),(0,p.jsx)("p",{children:r})]}))},g=()=>{const e="https://api.beschaffungsmarkt.com",s=(0,o.Zp)(),[a,t]=(0,l.useState)(null),[n,g]=(0,l.useState)(null),{showAlert:w}=(0,i.M)(),[j,b]=(0,l.useState)(!1),[v,N]=(0,l.useState)(""),[y,P]=(0,l.useState)(""),[C,k]=(0,l.useState)(""),[S,A]=(0,l.useState)(""),[F,D]=(0,l.useState)(""),E=(0,d.wA)(),I=(0,o.zy)(),{data:L,requestStatus:_,error:G}=(0,d.d4)(e=>e.user);(0,l.useEffect)(()=>{E((0,m.me)())},[E,I]),console.log("user data -: ",L),"rejected"===_&&(localStorage.setItem("procurement_token",""),w("Token Expire Login Again"),s("/login")),(0,l.useEffect)(()=>{L.avatar?(t(L.avatar||""),g(L.avatar||""),b(!1)):(t(""),g("")),N(L.first_name||""),P(L.last_name||"")},[L,I]);const[R,q]=(0,l.useState)("");return(0,p.jsxs)("div",{className:"d-flex flex-column align-items-start justify-content-start w-100",children:[(0,p.jsx)("h5",{style:{fontWeight:"700"},children:"User Profile"}),(0,p.jsxs)("div",{className:"d-flex flex-column w-100 align-items-start justify-content-start text-start das-general-form mt-2",children:[(0,p.jsxs)("div",{className:"d-flex flex-column flex-md-row w-100 align-items-start justify-content-start text-start",children:[(0,p.jsx)("div",{className:"col-12 col-md-6 d-flex flex-column align-items-center justify-content-center",children:(0,p.jsx)("div",{className:"image-div-das-general-form d-flex flex-column align-items-center justify-content-center w-100",children:n?(0,p.jsxs)("div",{className:"d-flex flex-row align-item-end justify-content-end",children:[(0,p.jsx)("img",{src:j?n:"".concat(e,"/files/").concat(a),alt:"Selected",className:"rounded-circle border border-1 border-dark image-div-das-image"}),(0,p.jsx)(c.j55,{style:{cursor:"pointer",fontSize:"20px"},onClick:()=>{t(""),g(""),b(!0)}})]}):(0,p.jsx)(p.Fragment,{children:(0,p.jsx)(h,{accept:"image/*",onFileDrop:e=>{b(!0),t(e),g(URL.createObjectURL(e))},className:"image-div-das-image-upload",label:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(r.LEk,{className:"fs-2 mb-3"})," ",(0,p.jsxs)("p",{children:[(0,p.jsx)("b",{children:"Click to upload"})," or drag and drop"]})," ",(0,p.jsx)("p",{style:{fontSize:"12px"},children:" SVG, PNG, JPG or WEBP"})]})})})})}),(0,p.jsx)("div",{className:"col-12 col-md-6 d-flex flex-column align-items-start justify-content-end gap-3 ps-0 ps-md-4",children:L.is_verified?null:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"d-flex text-start dssh-profile-email-var w-100 mt-3 mt-md-0",children:(0,p.jsx)("p",{children:"Your email has not been verified yet. You need to check your email before you can do anything else."})}),(0,p.jsx)("div",{className:"d-flex align-item-end justify-content-end p-0 w-100",children:(0,p.jsx)("button",{className:"das-button-end save-button",onClick:async()=>{try{const s=await u.A.post("".concat(e,"/api/auth/send-verify-email"),{email:L.email},{withCredentials:!0});s.data.status&&w((0,p.jsxs)("div",{className:"d-flex align-items-center justify-content-start gap-1",children:[(0,p.jsx)(x.v_8,{className:"text-success fs-1"}),s.data.msg]}),"success")}catch(n){var s,a,t,l;const e=(null===(s=n.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.msg)||(null===(t=n.response)||void 0===t||null===(l=t.data)||void 0===l?void 0:l.error)||n.message||"Something went wrong";w((0,p.jsxs)("div",{className:"d-flex align-items-center justify-content-start gap-1",children:[(0,p.jsx)(f._Jm,{className:"text-danger fs-3"}),e]}),"danger")}},children:"Get the verified email"})})]})})]}),(0,p.jsxs)("div",{className:"d-flex flex-column flex-md-row w-100 align-items-start justify-content-start text-start",children:[(0,p.jsxs)("div",{className:"col-12 col-md-6 d-flex flex-column align-items-start justify-content-center gap-3 pe-0 pe-md-4",children:[(0,p.jsxs)("div",{className:"w-100",children:[(0,p.jsx)("label",{for:"website",className:"das-form-label",children:"First Name"}),(0,p.jsx)("input",{type:"text",value:v,onChange:e=>N(e.target.value),class:"form-control ".concat(R.firstName?"border-danger":""),id:"Fax Number","aria-describedby":"website",name:"firstName",placeholder:"First Name"}),R.firstName&&(0,p.jsx)("small",{className:"text-danger",children:R.firstName})]}),(0,p.jsxs)("div",{className:"w-100",children:[(0,p.jsx)("label",{for:"website",className:"das-form-label",children:"Last Name "}),(0,p.jsx)("input",{type:"text",value:y,onChange:e=>P(e.target.value),class:"form-control ".concat(R.lastName?"border-danger":""),id:"Website","aria-describedby":"website",name:"lastName",placeholder:"Last Name"}),R.lastName&&(0,p.jsx)("small",{className:"text-danger",children:R.lastName})]}),(0,p.jsxs)("div",{className:"w-100",children:[(0,p.jsx)("label",{for:"website",className:"das-form-label",children:"Email"}),(0,p.jsx)("input",{type:"text",class:"form-control",id:"HS Code","aria-describedby":"website",value:L.email,disabled:!0,placeholder:"Email"})]}),(0,p.jsx)("div",{className:"d-flex align-item-end justify-content-end p-0 w-100",children:(0,p.jsx)("button",{className:"das-button-end save-button",onClick:async t=>{t.preventDefault();const l=new FormData;l.append("firstName",v),l.append("lastName",y),j&&(a?l.append("avatarImg",a):l.append("avatarImg","false"));try{const a=await u.A.post("".concat(e,"/api/users/update-user-profile"),l,{headers:{"Content-Type":"multipart/form-data"},withCredentials:!0});w(a.data.msg,"success"),s("/dashboard"),console.log("Contact Info updated successfully")}catch(n){const e=n.response.data;if(q({}),e){const s={};for(const a in e)e[a]&&(s[a]=e[a]);q(s)}}},children:"Save"})})]}),(0,p.jsxs)("div",{className:"col-12 col-md-6 d-flex flex-column align-items-start justify-content-center gap-3 ps-0 ps-md-4",children:[(0,p.jsxs)("div",{className:"w-100",children:[(0,p.jsx)("label",{for:"website",className:"das-form-label",children:"Current Password"}),(0,p.jsx)("input",{type:"password",value:C,onChange:e=>k(e.target.value),class:"form-control ".concat(R.currentPassword?"border-danger":""),id:"Founded Year","aria-describedby":"website",name:"currentPassword",placeholder:"Current Password"}),R.currentPassword&&(0,p.jsx)("small",{className:"text-danger",children:R.currentPassword})]}),(0,p.jsxs)("div",{className:"w-100",children:[(0,p.jsx)("label",{for:"website",className:"das-form-label",children:"New Password"}),(0,p.jsx)("input",{type:"password",value:S,onChange:e=>A(e.target.value),class:"form-control ".concat(R.newPassword?"border-danger":""),id:"website","aria-describedby":"website",name:"newPassword",placeholder:"new password"}),R.newPassword&&(0,p.jsx)("small",{className:"text-danger",children:R.newPassword})]}),(0,p.jsxs)("div",{className:"w-100",children:[(0,p.jsx)("label",{for:"website",className:"das-form-label",children:"Confirm Password"}),(0,p.jsx)("input",{type:"password",value:F,onChange:e=>D(e.target.value),class:"form-control ".concat(R.confirmPassword?"border-danger":""),id:"website","aria-describedby":"website",name:"confirmPassword",placeholder:"confirm password"}),R.confirmPassword&&(0,p.jsx)("small",{className:"text-danger",children:R.confirmPassword})]}),(0,p.jsx)("div",{className:"d-flex align-item-end justify-content-end p-0 w-100",children:(0,p.jsx)("button",{className:"das-button-end save-button",onClick:async a=>{if(a.preventDefault(),C.length<=0)q({currentPassword:"Current password is required."});else if(S.length<=0)q({newPassword:"New password is required."});else if(F===S)try{const a=await u.A.post("".concat(e,"/api/users/change-password"),{currentPassword:C,newPassword:S},{headers:{"Content-Type":"application/json"},withCredentials:!0});w(a.data.msg,"success"),s("/dashboard"),console.log("Contact Info updated successfully")}catch(t){console.log(t),w(t.response.data.msg);const e=t.response.data;if(q({}),e){const s={};for(const a in e)e[a]&&(s[a]=e[a]);q(s)}}else q({confirmPassword:"Passwords must match."})},children:"Reset Password"})})]})]})]})]})}}}]);
//# sourceMappingURL=2648.feaf6b70.chunk.js.map