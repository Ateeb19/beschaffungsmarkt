{"version":3,"file":"static/js/374.84a8629e.chunk.js","mappings":"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","sources":["Components/Dashboard/Das_Message.js"],"sourcesContent":["import React, { useCallback, useEffect, useRef, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { fetchUserChats } from \"../../redux/userChatSlice\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport { fetchUserInfo } from \"../../redux/userSlice\";\nimport { IoIosCheckmarkCircle } from \"react-icons/io\";\nimport { useAlert } from \"../alert/Alert_message\";\nimport axios from \"axios\";\nimport { GrAttachment } from \"react-icons/gr\";\nimport { FaRegFolder } from \"react-icons/fa6\";\nimport { TiWarning } from \"react-icons/ti\";\nimport { MdError } from \"react-icons/md\";\nimport { useDropzone } from \"react-dropzone\";\n\n\nconst DragAndDrop = ({ accept, onFileDrop, label, className }) => {\n    const onDrop = useCallback(\n        (acceptedFiles) => {\n            if (acceptedFiles.length > 0) {\n                // const file = acceptedFiles[0];\n                // onFileDrop(file);\n                onFileDrop(acceptedFiles);\n            }\n        },\n        [onFileDrop]\n    );\n\n    const { getRootProps, getInputProps, isDragActive } = useDropzone({\n        onDrop,\n        accept,\n        multiple: true,\n    });\n\n    return (\n        <div\n            {...getRootProps()}\n            className={`d-flex flex-column align-items-center justify-content-center text-center ${className}`}\n        >\n            <div>\n                <input {...getInputProps()} />\n                <p>{label}</p>\n            </div>\n        </div>\n    );\n};\nconst Das_Message = () => {\n\n    const Backend_URL = process.env.REACT_APP_API_URL;\n    const Backend_CHAT_URL = process.env.REACT_APP_CHAT_URL;\n    const Backend_CHAT_FILE = process.env.REACT_APP_CHAT_FILE;\n    const [selected_chat, setSelected_chat] = useState(null);\n    const [activeChatId, setActiveChatId] = useState(null);\n    const [messageText, setMessageText] = useState(\"\");\n    const navigate = useNavigate();\n    const { showAlert } = useAlert();\n    const dispatch = useDispatch();\n    const location = useLocation();\n\n    const {\n        data,\n        requestStatus: userStatus,\n        error: userError\n    } = useSelector((state) => state.user);\n\n    const {\n        chatData,\n        requestStatus: chatStatus,\n        error: chatError\n    } = useSelector((state) => state.user_chat);\n    useEffect(() => {\n        dispatch(fetchUserInfo());\n    }, [dispatch, location])\n\n    // useEffect(() => {\n    //     dispatch(fetchUserChats());\n    // }, [dispatch, location, selected_chat])\n    useEffect(() => {\n        if (selected_chat) {\n            dispatch(fetchUserChats());\n        }\n    }, [selected_chat]);\n\n    console.log('the data -: ', chatData);\n    // useEffect(() => {\n    //     if (chatStatus === \"fulfilled\") {\n    //         dispatch(fetchUserChats());\n    //     }\n    // }, [chatStatus]);\n    // useEffect(() => {\n    //     dispatch(fetchUserInfo());\n    //     dispatch(fetchUserChats());\n    // }, [dispatch, location, selected_chat]);\n    // console.log('chates-: ', chatData);\n    // console.log('user data-: ', data);\n    const [selectedFiles, setSelectedFiles] = useState([]);\n\n\n    const handleFileDrop = (files) => {\n        const allowedExtensions = [\"jpg\", \"jpeg\", \"png\", \"pdf\"];\n\n        const validFiles = [];\n        files.forEach((file) => {\n            const ext = file.name.split(\".\").pop().toLowerCase();\n\n            if (!allowedExtensions.includes(ext)) {\n                showAlert(`Invalid file: ${file.name}. Only JPG, JPEG, PNG, PDF allowed.`, 'warning');\n                return;\n            }\n\n            validFiles.push(file);\n\n        });\n\n        setSelectedFiles((prev) => [...prev, ...validFiles]);\n    };\n\n    const removeFile = (index) => {\n        setSelectedFiles((prev) => prev.filter((_, i) => i !== index));\n    };\n\n\n\n    const [ws, setWs] = useState(null);\n    const [socket, setSocket] = useState(null);\n    const userId = data?._id;\n    const [uploadedFiles, setUploadedFiles] = useState();\n    const [uploadedFileTypes, setUploadedFileTypes] = useState();\n    const [searchText, setSearchText] = useState(\"\");\n\n    const timeAgo = (dateString) => {\n        const created = new Date(dateString);\n        const now = new Date();\n        const diff = (now - created) / 1000; // diff in seconds\n\n        if (diff < 60) {\n            return diff < 10 ? \"just now\" : `${Math.floor(diff)} seconds ago`;\n        }\n\n        const minutes = diff / 60;\n        if (minutes < 60) {\n            return minutes < 2 ? \"a minute ago\" : `${Math.floor(minutes)} minutes ago`;\n        }\n\n        const hours = minutes / 60;\n        if (hours < 24) {\n            return hours < 2 ? \"an hour ago\" : `${Math.floor(hours)} hours ago`;\n        }\n\n        const days = hours / 24;\n        if (days < 2) {\n            return \"a day ago\";\n        }\n        if (days < 30) {\n            return `${Math.floor(days)} days ago`;\n        }\n\n        const months = days / 30;\n        if (months < 12) {\n            return months < 2 ? \"a month ago\" : `${Math.floor(months)} months ago`;\n        }\n\n        const years = months / 12;\n        return years < 2 ? \"a year ago\" : `${Math.floor(years)} years ago`;\n    };\n\n    const filteredChats = chatData?.allChatData?.filter(chat =>\n        chat.title.toLowerCase().includes(searchText.toLowerCase())\n    );\n\n\n    const fileToBase64 = (file) => {\n        return new Promise((resolve, reject) => {\n            const reader = new FileReader();\n            reader.onload = () => resolve(reader.result.split(\",\")[1]); // remove prefix\n            reader.onerror = reject;\n            reader.readAsDataURL(file);\n        });\n    };\n\n    const handle_chate = async (c) => {\n        setActiveChatId(c._id);\n\n        try {\n            const res = await axios.post(`${Backend_URL}/api/messages`, {\n                chatId: c._id,\n                itemsPerPage: 20,\n                lastMessageCreatedTime: '',\n                page: 1\n            }, { withCredentials: true });\n\n            setSelected_chat({\n                chat_info: c,\n                // messages: res.data\n                messages: res.data.slice().reverse()\n            });\n\n            // CLOSE OLD SOCKET IF EXISTS\n            if (socket) {\n                socket.close();\n            }\n            connectWebSocket(c._id);\n        } catch (e) {\n            const errorMessage =\n                e.response?.data?.msg ||\n                e.response?.data?.error ||\n                e.message ||\n                \"Something went wrong\";\n\n            showAlert(\n                <div className=\"d-flex align-items-center justify-content-start gap-1\">\n                    <MdError className=\"text-danger fs-3\" />\n                    {errorMessage}\n                </div>,\n                \"danger\"\n            );\n        }\n    };\n\n    console.log(selected_chat);\n\n    const connectWebSocket = (chatId) => {\n        // close previous connection if exists\n        if (socket) socket.close();\n\n        const ws = new WebSocket(`${Backend_CHAT_URL}`);\n        setSocket(ws);\n\n        ws.onopen = () => {\n            // console.log(\"WebSocket Connected\");\n\n            // authenticate immediately after connection\n            ws.send(JSON.stringify({\n                type: \"authenticate\",\n                data: {\n                    userId: userId,\n                    chatId: chatId,\n                }\n            }));\n        };\n\n        ws.onmessage = (event) => {\n            const incoming = JSON.parse(event.data);\n\n            if (incoming.type === \"reply_message\") {\n                // update UI in real-time\n                setSelected_chat(prev => ({\n                    ...prev,\n                    messages: [...prev.messages, incoming.data]\n                }));\n            }\n        };\n\n        ws.onclose = () => console.log(\"WebSocket Disconnected\");\n        ws.onerror = (error) => console.log(\"WebSocket Error:\", error);\n    };\n\n\n    // const handleSendMessage = () => {\n    //     const isMessageEmpty = !messageText || messageText.trim() === \"\";\n    //     if (isMessageEmpty) {\n    //         showAlert(<div className=\"d-flex gap-1 justify-content-center align-items-center text-start me-3\">\n    //             <TiWarning className=\"text-warning fs-5\" />\n    //             <span>Write a message!</span> </div>, \"warning\")\n    //         return;\n    //     }\n\n    //     if (!socket || socket.readyState !== WebSocket.OPEN) {\n    //         showAlert(<div className=\"d-flex gap-1 justify-content-center align-items-center text-start me-3\">\n    //             <TiWarning className=\"text-warning fs-5\" />\n    //             <span>Something went wrong!</span> </div>, \"warning\")\n    //         return;\n    //     }\n\n    //     socket.send(JSON.stringify({\n    //         type: \"reply_message\",\n    //         data: {\n    //             chatId: activeChatId,\n    //             senderId: userId,\n    //             message: messageText,\n    //             file: uploadedFiles || null,\n    //             fileType: uploadedFileTypes || null,\n    //         }\n    //     }));\n\n    //     setMessageText(\"\");\n    //     setTimeout(() => {\n    //         handle_chate(selected_chat.chat_info);\n    //     }, 0.2);\n    // };\n\n\n    const handleSendMessage = async () => {\n        if (!messageText.trim() && selectedFiles.length === 0) {\n            showAlert(\"Write a message or attach a file!\", \"warning\");\n            return;\n        }\n\n        if (!socket || socket.readyState !== WebSocket.OPEN) {\n            showAlert(\"Socket is not connected!\", \"warning\");\n            return;\n        }\n\n        // const newMessage = {\n        //     _id: Math.random().toString(36).substr(2, 9), // temporary unique ID\n        //     chatId: activeChatId,\n        //     sender: userId,\n        //     message: messageText,\n        //     file: selectedFiles.map(f => f.name), // display file names immediately\n        //     created_time: new Date().toISOString(),\n        // };\n\n        // // 2️⃣ Update the chat instantly\n        // setSelected_chat(prev => ({\n        //     ...prev,\n        //     messages: [...prev.messages, newMessage]\n        // }));\n\n        const base64Files = await Promise.all(\n            selectedFiles.map(file => fileToBase64(file))\n        );\n\n        const fileTypes = selectedFiles.map(file =>\n            file.name.split(\".\").pop().toLowerCase()\n        );\n\n        socket.send(JSON.stringify({\n            type: \"reply_message\",\n            data: {\n                chatId: activeChatId,\n                senderId: userId,\n                message: messageText || \"\",\n                file: base64Files.length > 0 ? base64Files : null,\n                fileType: fileTypes.length > 0 ? fileTypes : null,\n            }\n        }));\n\n        setMessageText(\"\");\n        setSelectedFiles([]);\n        // setTimeout(() => {\n        //     handle_chate(selected_chat.chat_info);\n        // }, 2);\n    };\n\n    const chatScrollRef = useRef(null);\n\n    useEffect(() => {\n        if (chatScrollRef.current) {\n            chatScrollRef.current.scrollTop = chatScrollRef.current.scrollHeight;\n        }\n    }, [selected_chat?.messages]);\n\n\n    const formatChatDate = (isoString) => {\n        const date = new Date(isoString);\n        const now = new Date();\n\n        const options = {\n            month: \"short\",\n            day: \"2-digit\",\n            year: \"numeric\",\n            hour: \"2-digit\",\n            minute: \"2-digit\",\n            hour12: true\n        };\n\n        const formattedDate = date.toLocaleString(\"en-US\", options);\n\n        const diffMs = now - date;\n        const diffSec = Math.floor(diffMs / 1000);\n        const diffMin = Math.floor(diffSec / 60);\n        const diffHr = Math.floor(diffMin / 60);\n        const diffDay = Math.floor(diffHr / 24);\n\n        let relative = \"\";\n\n        if (diffSec < 60) relative = `${diffSec} sec ago`;\n        else if (diffMin < 60) relative = `${diffMin} min ago`;\n        else if (diffHr < 24) relative = `${diffHr} hour${diffHr > 1 ? \"s\" : \"\"} ago`;\n        else if (diffDay === 1) relative = `a day ago`;\n        else relative = `${diffDay} days ago`;\n\n        return `${formattedDate} (${relative})`;\n    };\n\n    return (\n        <div className=\"d-flex flex-column align-items-start justify-content-start w-100 p-1\">\n            <div className=\"d-flex align-items-start justify-content-start w-100 dash-message\"><h2>Your Messages</h2></div>\n\n            {/* <div className=\"container-fluid p-0 msg-outer-div border p-2\">\n                <div className=\"row g-0 h-100\">\n                    <div className=\"col-4 d-flex flex-column  pe-2\" style={{ height: \"100%\" }}>\n                        <div className=\"w-100 dash-message-box-left\">\n                            <div className=\"w-100 py-1 px-2\">\n                                <input className=\"form-control w-100 message-search\" placeholder=\"Search...\" />\n                            </div> */}\n            <div className=\"container-fluid p-0 msg-outer-div border p-2\"\n                // style={{ height: \"calc(100vh - 130px)\" }}\n                >\n                <div className=\"row g-0 h-100\">\n\n                    <div className=\"col-12 col-md-4 d-flex flex-column pe-2 h-100\">\n                        <div className=\"d-flex flex-column w-100 dash-message-box-left\">\n\n                            <div className=\"w-100 py-1 px-2\">\n                                {/* <input className=\"form-control w-100 message-search\" placeholder=\"Search...\" /> */}\n                                <input\n                                    className=\"form-control w-100 message-search\"\n                                    placeholder=\"Search...\"\n                                    value={searchText}\n                                    onChange={(e) => setSearchText(e.target.value)}\n                                />\n                            </div>\n                            <div className=\"flex-grow-1 overflow-auto h-100\">\n                                <div className=\"w-100 mt-4 d-flex flex-column align-items-start justify-content-start\">\n                                    {chatData?.allChatData?.length > 0 && (\n                                        <>\n                                            {/* {chatData?.allChatData?.map((c, key) => ( */}\n                                            {filteredChats?.map((c, key) => (\n                                                <>\n                                                    <div\n                                                        className={`d-flex flex-column w-100 align-items-start justify-content-start border-bottom dash-msg-left ${activeChatId === c._id ? \"dash-msg-left-active\" : \"dash-msg-left\"}`}\n                                                        key={key}\n                                                        onClick={() => handle_chate(c)}\n                                                    >\n                                                        <div className=\"d-flex align-items-start justify-content-between w-100 \">\n                                                            <div className=\"d-flex flex-column align-items-start justify-content-start\">\n                                                                <h3>{c.title}</h3>\n                                                                {c.sender._id === data._id ? (\n                                                                    <>\n                                                                        {c.receiver.contact_first_name && c.receiver.contact_last_name ? (\n                                                                            <>\n                                                                                <span>{c.receiver.contact_first_name} {c.receiver.contact_last_name}</span>\n                                                                            </>\n                                                                        ) : (\n                                                                            <>\n                                                                                <span>{c.receiver.company_name}</span>\n                                                                            </>\n                                                                        )}\n                                                                    </>\n                                                                ) : (\n                                                                    <>\n                                                                        {c.sender.contact_first_name && c.sender.contact_last_name ? (\n                                                                            <>\n                                                                                <span>{c.sender.contact_first_name} {c.sender.contact_last_name}</span>\n                                                                            </>\n                                                                        ) : (\n                                                                            <>\n                                                                                <span>{c.sender.company_name}</span>\n                                                                            </>\n                                                                        )}\n                                                                    </>\n                                                                )}\n\n                                                            </div>\n                                                            <div className=\"d-flex flex-column align-items-end justify-content-start\">\n                                                                <span className=\"display_time\">{timeAgo(c.created_time)}</span>\n                                                                {c.unreadMsg != 0 && (\n                                                                    <>\n                                                                        <span className=\"display_num_msg\">{c.unreadMsg}</span>\n                                                                    </>\n                                                                )}\n                                                            </div>\n                                                        </div>\n                                                    </div>\n                                                </>\n                                            ))}\n                                        </>\n                                    )}\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Right side - Selected chat */}\n                    <div className=\"col-12 col-md-8 d-flex flex-column \" style={{ height: \"100%\" }}>\n\n                        {selected_chat && (\n                            <>\n                                <div className=\"\">\n                                    <div className=\"d-flex flex-column align-items-start justify-content-start w-100 p-1 dash-chat-outer-div\">\n                                        <div className=\"dash-right-msg-top w-100 d-flex flex-column align-items-start gap-2 py-3\">\n                                            <h1>{selected_chat.chat_info.title}</h1>\n                                            <button\n                                                className=\"\"\n                                                onClick={() => navigate(`/company/${selected_chat.chat_info.sender._id}`)}\n                                            >{selected_chat.chat_info.sender.contact_first_name && selected_chat.chat_info.sender.contact_last_name ? (\n                                                <>\n                                                    <span>{selected_chat.chat_info.sender.contact_first_name} {selected_chat.chat_info.sender.contact_last_name}</span>\n                                                </>\n                                            ) : (\n                                                <>\n                                                    <span>{selected_chat.chat_info.sender.company_name}</span>\n                                                </>\n                                            )}</button>\n                                        </div>\n                                    </div>\n                                </div>\n\n\n                                {/* Chat messages - scrollable */}\n                                <div className=\"flex-grow-1 overflow-auto \"\n                                    ref={chatScrollRef}\n                                >\n                                    <div className=\"dash-right-msg-chat-box w-100 d-flex flex-column align-items-start justify-content-end pb-3 \">\n                                        <div className=\"d-flex flex-column justify-content-end align-items-end h-100 w-100\">\n                                            {selected_chat?.messages?.map((chat, key) => (\n                                                <>\n                                                    <div className=\"chat-inner-box w-100 d-flex flex-column align-items-start justify-content-start\">\n                                                        <div className=\"chat-box-profile d-flex flex-row align-items-start justify-content-start gap-2\">\n                                                            <img src={chat.sender === selected_chat.chat_info.sender._id ? selected_chat.chat_info.sender.contact_img ? `${Backend_URL}/files/${selected_chat.chat_info.sender.contact_img}` : '/Images/user-avatar-CZ6R_fL7.webp' : selected_chat.chat_info.receiver.contact_img ? `${Backend_URL}/files/${selected_chat.chat_info.receiver.contact_img}` : '/Images/user-avatar-CZ6R_fL7.webp'} alt=\"\" />\n                                                            <div className=\"chat-inner-box-id d-flex flex-column align-items-start justify-content-start\">\n                                                                {chat.sender === selected_chat.chat_info.sender._id ? selected_chat.chat_info.sender.contact_first_name ? <>\n                                                                    <label>{selected_chat.chat_info.sender.contact_first_name} {selected_chat.chat_info.sender.contact_last_name}</label>\n                                                                    <span>{selected_chat.chat_info.sender.contact_email}</span>\n                                                                </> : <>\n                                                                    <label>{selected_chat.chat_info.sender.company_name}</label>\n\n                                                                </> : selected_chat.chat_info.receiver.contact_first_name ? <>\n                                                                    <label>{selected_chat.chat_info.receiver.contact_first_name} {selected_chat.chat_info.receiver.contact_last_name}</label>\n                                                                    <span>{selected_chat.chat_info.receiver.contact_email}</span>\n                                                                </> : <>\n                                                                    <label>{selected_chat.chat_info.receiver.company_name}</label>\n                                                                </>}\n                                                            </div>\n                                                        </div>\n                                                        <div className=\"chat-box-text d-flex flex-column align-items-start justify-content-start w-100\">\n                                                            <span>{chat.message} </span>\n                                                            {chat?.file.length > 0 && (\n                                                                <>\n                                                                    <div className=\"d-flex flex-wrap align-items-start justify-content-start w-100 gap-3 mt-3\">\n                                                                        {chat?.file.map((f, key) => (\n                                                                            <>\n                                                                                <div key={key}\n                                                                                    // onClick={() => navigate(`${Backend_URL}/files/${f}`)}\n                                                                                    onClick={() => {\n                                                                                        const link = document.createElement(\"a\");\n                                                                                        link.href = `${Backend_CHAT_FILE}/files/${f}`;\n                                                                                        link.download = f; // forces download\n                                                                                        document.body.appendChild(link);\n                                                                                        link.click();\n                                                                                        document.body.removeChild(link);\n                                                                                    }}\n                                                                                    className=\"chat-box-text-file d-flex flex-column align-items-start justify-content-start text-start gap-1\">\n                                                                                    <div className=\"chat-box-text-file-inner d-flex flex-column align-items-start justify-content-start\">\n                                                                                        <FaRegFolder className=\"fs-5 text-secondary\" />\n                                                                                        <span>{f}</span>\n                                                                                    </div>\n                                                                                </div>\n                                                                            </>\n                                                                        ))}\n                                                                    </div>\n                                                                </>\n                                                            )}\n\n                                                        </div>\n\n                                                        <div className=\"chat-box-date d-flex align-items-start justify-content-end w-100\">\n                                                            <span>{formatChatDate(chat.created_time)} </span>\n                                                        </div>\n                                                    </div>\n                                                </>\n                                            ))}\n                                        </div>\n\n                                    </div>\n                                    {/* {Array.from({ length: 30 }).map((_, i) => (\n                                <div\n                                    key={i}\n                                    className={`d-flex flex-column mb-3 ${i % 2 === 0 ? \"align-items-start\" : \"align-items-end\"}`}\n                                >\n                                    <div\n                                        className={`p-2 rounded ${i % 2 === 0 ? \"bg-white\" : \"bg-primary text-white\"}`}\n                                        style={{ maxWidth: \"70%\" }}\n                                    >\n                                        Lorem ipsum dolor sit amet, consectetur adipiscing elit. #{i + 1}\n                                    </div>\n                                    <small className=\"text-muted mt-1\">{new Date().toLocaleTimeString()}</small>\n                                </div>\n                            ))} */}\n                                </div>\n                                <div className=\"dash-right-msg-chat-input w-100 d-flex flex-column align-items-start justify-content-start py-2 gap-3\">\n                                    {selectedFiles.length > 0 && (\n                                        <div className=\"dash-msg-selected-file d-flex flex-wrap align-items-start justify-content-start w-100 gap-3 px-2\">\n                                            {selectedFiles.map((file, index) => (\n                                                <div className=\"dash-msg-file position-relative d-flex flex-column align-items-start justify-content-start text-start gap-1 p-2\">\n                                                    <button\n                                                        onClick={() => removeFile(index)}\n                                                        className=\"position-absolute top-0 end-0 btn p-0 m-1 me-2\"\n                                                        style={{\n                                                            background: \"transparent\",\n                                                            border: \"none\",\n                                                            fontSize: \"16px\",\n                                                            cursor: \"pointer\",\n                                                            color: \"dark\",\n                                                            lineHeight: \"1\"\n                                                        }}\n                                                    >\n                                                        x\n                                                    </button>\n                                                    <FaRegFolder className=\"fs-5 text-secondary\" />\n                                                    <span key={index} className=\"me-2\">\n                                                        {file.name}\n                                                    </span>\n                                                </div>\n                                            ))}\n                                        </div>\n                                    )}\n                                    <textarea\n                                        rows={3}\n                                        className=\"form-control w-100\"\n                                        placeholder=\"Type your reply here...\"\n                                        value={messageText}\n                                        onChange={(e) => setMessageText(e.target.value)}\n                                    />\n\n                                    <div className=\"d-flex flex-row align-items-start justify-content-between w-100 px-2\">\n                                        <DragAndDrop\n                                            accept={{\n                                                \"image/*\": [\".jpg\", \".jpeg\", \".png\"],\n                                                \"application/pdf\": [\".pdf\"],\n                                            }}\n                                            onFileDrop={handleFileDrop}\n                                            className=\"p-0\"\n                                            label={\n                                                <>\n                                                    <GrAttachment className=\"fs-4 text-secondary\" />\n                                                </>\n                                            } />\n\n\n                                        <button\n                                            className=\"das-button-end save-button\"\n                                            onClick={handleSendMessage}\n                                        >\n                                            Reply\n                                        </button>\n                                    </div>\n                                </div>\n                            </>\n                        )}\n\n\n                        {/* Chat input */}\n                        {/* <div className=\"p-3 border-top\">\n                            <div className=\"d-flex\">\n                                <textarea\n                                    className=\"form-control me-2\"\n                                    placeholder=\"Type a message...\"\n                                    rows={1}\n                                    style={{ resize: \"none\" }}\n                                ></textarea>\n                                <button className=\"btn btn-primary\">Send</button>\n                            </div>\n                        </div> */}\n                    </div>\n                </div>\n            </div>\n\n\n\n\n\n\n            {/* <div className=\"container-fluid vh-100 mt-1 p-0 dash-message-box\">\n                <div className=\"col-4 dash-message-box-left h-100\">\n                    <div className=\"w-100 py-1 px-2\">\n                        <input className=\"form-control w-100 message-search\" placeholder=\"Search...\" />\n                    </div>\n                    <div className=\"w-100 mt-4 d-flex flex-column align-items-start justify-content-start\">\n                        {chatData?.allChatData?.length > 0 && (\n                            <>\n                                {chatData?.allChatData?.map((c, key) => (\n                                    <>\n                                        <div\n                                            className={`d-flex flex-column w-100 align-items-start justify-content-start border-bottom dash-msg-left ${activeChatId === c._id ? \"dash-msg-left-active\" : \"dash-msg-left\"}`}\n                                            key={key}\n                                            onClick={() => handle_chate(c)}\n                                        >\n                                            <div className=\"d-flex align-items-start justify-content-between w-100 \">\n                                                <div className=\"d-flex flex-column align-items-start justify-content-start\">\n                                                    <h3>{c.title}</h3>\n                                                    {c.sender._id === data._id ? (\n                                                        <>\n                                                            {c.receiver.contact_first_name && c.receiver.contact_last_name ? (\n                                                                <>\n                                                                    <span>{c.receiver.contact_first_name} {c.receiver.contact_last_name}</span>\n                                                                </>\n                                                            ) : (\n                                                                <>\n                                                                    <span>{c.receiver.company_name}</span>\n                                                                </>\n                                                            )}\n                                                        </>\n                                                    ) : (\n                                                        <>\n                                                            {c.sender.contact_first_name && c.sender.contact_last_name ? (\n                                                                <>\n                                                                    <span>{c.sender.contact_first_name} {c.sender.contact_last_name}</span>\n                                                                </>\n                                                            ) : (\n                                                                <>\n                                                                    <span>{c.sender.company_name}</span>\n                                                                </>\n                                                            )}\n                                                        </>\n                                                    )}\n\n                                                </div>\n                                                <div className=\"d-flex flex-column align-items-end justify-content-start\">\n                                                    <span className=\"display_time\">{timeAgo(c.created_time)}</span>\n                                                    {c.unreadMsg != 0 && (\n                                                        <>\n                                                            <span className=\"display_num_msg\">{c.unreadMsg}</span>\n                                                        </>\n                                                    )}\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </>\n                                ))}\n                            </>\n                        )}\n                    </div>\n                </div>\n                <div className=\"col-8 dash-message-box-right h-100\">\n                    {selected_chat && (\n                        <>\n                            <div className=\"d-flex flex-column align-items-start justify-content-start w-100 p-1 dash-chat-outer-div\">\n                                <div className=\"dash-right-msg-top w-100 d-flex flex-column align-items-start gap-2 py-3\">\n                                    <h1>{selected_chat.chat_info.title}</h1>\n                                    <button\n                                        className=\"\"\n                                        onClick={() => navigate(`/company/${selected_chat.chat_info.sender._id}`)}\n                                    >{selected_chat.chat_info.sender.contact_first_name && selected_chat.chat_info.sender.contact_last_name ? (\n                                        <>\n                                            <span>{selected_chat.chat_info.sender.contact_first_name} {selected_chat.chat_info.sender.contact_last_name}</span>\n                                        </>\n                                    ) : (\n                                        <>\n                                            <span>{selected_chat.chat_info.sender.company_name}</span>\n                                        </>\n                                    )}</button>\n                                </div>\n                                <div className=\"dash-right-msg-chat-box w-100 d-flex flex-column align-items-start justify-content-end py-3\">\n                                    {selected_chat?.messages?.map((chat, key) => (\n                                        <>\n                                            <div className=\"chat-inner-box w-100 d-flex flex-column align-items-start justify-content-start\">\n                                                <div className=\"chat-box-profile d-flex flex-row align-items-start justify-content-start gap-2\">\n                                                    <img src={chat.sender === selected_chat.chat_info.sender._id ? selected_chat.chat_info.sender.contact_img ? `${Backend_URL}/files/${selected_chat.chat_info.sender.contact_img}` : '/Images/user-avatar-CZ6R_fL7.webp' : selected_chat.chat_info.receiver.contact_img ? `${Backend_URL}/files/${selected_chat.chat_info.receiver.contact_img}` : '/Images/user-avatar-CZ6R_fL7.webp'} alt=\"\" />\n                                                    <div className=\"chat-inner-box-id d-flex flex-column align-items-start justify-content-start\">\n                                                        {chat.sender === selected_chat.chat_info.sender._id ? selected_chat.chat_info.sender.contact_first_name ? <>\n                                                            <label>{selected_chat.chat_info.sender.contact_first_name} {selected_chat.chat_info.sender.contact_last_name}</label>\n                                                            <span>{selected_chat.chat_info.sender.contact_email}</span>\n                                                        </> : <>\n                                                            <label>{selected_chat.chat_info.sender.company_name}</label>\n\n                                                        </> : selected_chat.chat_info.receiver.contact_first_name ? <>\n                                                            <label>{selected_chat.chat_info.receiver.contact_first_name} {selected_chat.chat_info.receiver.contact_last_name}</label>\n                                                            <span>{selected_chat.chat_info.receiver.contact_email}</span>\n                                                        </> : <>\n                                                            <label>{selected_chat.chat_info.receiver.company_name}</label>\n                                                        </>}\n                                                    </div>\n                                                </div>\n                                                <div className=\"chat-box-text d-flex flex-column align-items-start justify-content-start w-100\">\n                                                    <span>{chat.message} </span>\n                                                    {chat?.file.length > 0 && (\n                                                        <>\n                                                            <div className=\"d-flex flex-wrap align-items-start justify-content-start w-100 gap-3 mt-3\">\n                                                                {chat?.file.map((f, key) => (\n                                                                    <>\n                                                                        <div key={key}\n                                                                            // onClick={() => navigate(`${Backend_URL}/files/${f}`)}\n                                                                            onClick={() => {\n                                                                                const link = document.createElement(\"a\");\n                                                                                link.href = `${Backend_URL}/files/${f}`;\n                                                                                link.download = f; // forces download\n                                                                                document.body.appendChild(link);\n                                                                                link.click();\n                                                                                document.body.removeChild(link);\n                                                                            }}\n                                                                            className=\"chat-box-text-file d-flex flex-column align-items-start justify-content-start text-start gap-1\">\n                                                                            <div className=\"chat-box-text-file-inner d-flex flex-column align-items-start justify-content-start\">\n                                                                                <FaRegFolder className=\"fs-5 text-secondary\" />\n                                                                                <span>{f}</span>\n                                                                            </div>\n                                                                        </div>\n                                                                    </>\n                                                                ))}\n                                                            </div>\n                                                        </>\n                                                    )}\n\n                                                </div>\n\n                                                <div className=\"chat-box-date d-flex align-items-start justify-content-end w-100\">\n                                                    <span>{formatChatDate(chat.created_time)} </span>\n                                                </div>\n                                            </div>\n                                        </>\n                                    ))}\n                                </div>\n\n                                <div className=\"dash-right-msg-chat-input w-100 d-flex flex-column align-items-start justify-content-start py-2 gap-3\">\n                                    {selectedFiles.length > 0 && (\n                                        <div className=\"dash-msg-selected-file d-flex flex-wrap align-items-start justify-content-start w-100 gap-3 px-2\">\n                                            {selectedFiles.map((file, index) => (\n                                                <div className=\"dash-msg-file position-relative d-flex flex-column align-items-start justify-content-start text-start gap-1 p-2\">\n                                                    <button\n                                                        onClick={() => removeFile(index)}\n                                                        className=\"position-absolute top-0 end-0 btn p-0 m-1 me-2\"\n                                                        style={{\n                                                            background: \"transparent\",\n                                                            border: \"none\",\n                                                            fontSize: \"16px\",\n                                                            cursor: \"pointer\",\n                                                            color: \"dark\",\n                                                            lineHeight: \"1\"\n                                                        }}\n                                                    >\n                                                        x\n                                                    </button>\n                                                    <FaRegFolder className=\"fs-5 text-secondary\" />\n                                                    <span key={index} className=\"me-2\">\n                                                        {file.name}\n                                                    </span>\n                                                </div>\n                                            ))}\n                                        </div>\n                                    )}\n                                    <textarea\n                                        rows={3}\n                                        className=\"form-control w-100\"\n                                        placeholder=\"Type your reply here...\"\n                                        value={messageText}\n                                        onChange={(e) => setMessageText(e.target.value)}\n                                    />\n\n                                    <div className=\"d-flex flex-row align-items-start justify-content-between w-100 px-2\">\n                                        <DragAndDrop\n                                            accept={{\n                                                \"image/*\": [\".jpg\", \".jpeg\", \".png\"],\n                                                \"application/pdf\": [\".pdf\"],\n                                            }}\n                                            onFileDrop={handleFileDrop}\n                                            className=\"p-0\"\n                                            label={\n                                                <>\n                                                    <GrAttachment className=\"fs-4 text-secondary\" />\n                                                </>\n                                            } />\n\n\n                                        <button\n                                            className=\"das-button-end save-button\"\n                                            onClick={handleSendMessage}\n                                        >\n                                            Reply\n                                        </button>\n                                    </div>\n                                </div>\n\n                            </div>\n                        </>\n                    )}\n                </div>\n            </div> */}\n        </div>\n    )\n}\n\nexport default Das_Message;"],"names":["DragAndDrop","_ref","accept","onFileDrop","label","className","onDrop","useCallback","acceptedFiles","length","getRootProps","getInputProps","isDragActive","useDropzone","multiple","_jsx","_objectSpread","concat","children","_jsxs","Das_Message","_chatData$allChatData","_chatData$allChatData2","_selected_chat$messag","Backend_URL","process","selected_chat","setSelected_chat","useState","activeChatId","setActiveChatId","messageText","setMessageText","navigate","useNavigate","showAlert","useAlert","dispatch","useDispatch","location","useLocation","data","requestStatus","userStatus","error","userError","useSelector","state","user","chatData","chatStatus","chatError","user_chat","useEffect","fetchUserInfo","fetchUserChats","console","log","selectedFiles","setSelectedFiles","ws","setWs","socket","setSocket","userId","_id","uploadedFiles","setUploadedFiles","uploadedFileTypes","setUploadedFileTypes","searchText","setSearchText","timeAgo","dateString","created","Date","diff","Math","floor","minutes","hours","days","months","years","filteredChats","allChatData","filter","chat","title","toLowerCase","includes","connectWebSocket","chatId","close","WebSocket","onopen","send","JSON","stringify","type","onmessage","event","incoming","parse","prev","messages","onclose","onerror","chatScrollRef","useRef","current","scrollTop","scrollHeight","formatChatDate","isoString","date","now","formattedDate","toLocaleString","month","day","year","hour","minute","hour12","diffMs","diffSec","diffMin","diffHr","diffDay","relative","placeholder","value","onChange","e","target","_Fragment","map","c","key","onClick","async","res","axios","post","itemsPerPage","lastMessageCreatedTime","page","withCredentials","chat_info","slice","reverse","_e$response","_e$response$data","_e$response2","_e$response2$data","errorMessage","response","msg","message","MdError","handle_chate","sender","receiver","contact_first_name","contact_last_name","company_name","created_time","unreadMsg","style","height","ref","src","contact_img","alt","contact_email","file","f","link","document","createElement","href","download","body","appendChild","click","removeChild","FaRegFolder","index","_","i","removeFile","background","border","fontSize","cursor","color","lineHeight","name","rows","files","allowedExtensions","validFiles","forEach","ext","split","pop","push","GrAttachment","trim","readyState","OPEN","base64Files","Promise","all","resolve","reject","reader","FileReader","onload","result","readAsDataURL","fileToBase64","fileTypes","senderId","fileType"],"sourceRoot":""}